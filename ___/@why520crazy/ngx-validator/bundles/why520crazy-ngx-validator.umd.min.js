!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/forms"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@why520crazy/ngx-validator",["exports","@angular/core","@angular/forms","rxjs","rxjs/operators"],e):e((t.why520crazy=t.why520crazy||{},t.why520crazy["ngx-validator"]={}),t.ng.core,t.ng.forms,t.rxjs,t.rxjs.operators)}(this,function(t,n,o,r,i){"use strict";function a(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a}var s=new n.InjectionToken("NGX_VALIDATION_CONFIG"),e={required:"该选项不能为空",maxlength:"该选项输入值长度不能大于{requiredLength}",minlength:"该选项输入值长度不能小于{requiredLength}",ngxUniqueCheck:"输入值已经存在，请重新输入",email:"输入邮件的格式不正确",repeat:"两次输入不一致",pattern:"该选项输入格式不正确",number:"必须输入数字",url:"输入URL格式不正确",max:"该选项输入值不能大于{max}",min:"该选项输入值不能小于{min}"},l=function(){function t(){}return t.prototype.showError=function(t,e){},t.prototype.removeError=function(t){},t}(),u="is-invalid",c="invalid-feedback",d=function(){function t(){}return t.prototype.showError=function(t,e){if(t&&t.classList.add(u),t&&t.parentElement){var r=document.createDocumentFragment(),n=document.createElement("DIV"),o=document.createTextNode(e[0]);n.appendChild(o),n.setAttribute("class",c),r.appendChild(n),t.parentElement.append(r)}},t.prototype.removeError=function(t){if(t&&t.classList.remove(u),t&&t.parentElement){var e=t.parentElement.querySelector("."+c);e&&t.parentElement.removeChild(e)}},t}(),f=function(){function t(){}return t.noop=function(){return new l},t.bootstrap=function(){return new d},t}(),g={validationFeedbackStrategy:f.bootstrap(),validationMessages:{}},p=function(){function t(t){this.config=Object.assign({},g,t)}return t.prototype.getDefaultValidationMessage=function(t){return this.config.globalValidationMessages&&this.config.globalValidationMessages[t]?this.config.globalValidationMessages[t]:e[t]},Object.defineProperty(t.prototype,"validationMessages",{get:function(){return this.config.validationMessages},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"validationFeedbackStrategy",{get:function(){return this.config.validationFeedbackStrategy||(this.config.validationFeedbackStrategy=f.bootstrap()),this.config.validationFeedbackStrategy},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"validateOn",{get:function(){return this.config.validateOn||(this.config.validateOn="submit"),this.config.validateOn},enumerable:!0,configurable:!0}),t.prototype.getErrorMessage=function(t,e,r){return this.validationMessages[t]&&this.validationMessages[t][e]?this.validationMessages[t][e]:this.getDefaultValidationMessage(e)},t.prototype.addValidationMessages=function(t){Object.assign(this.config.validationMessages,t)},t.prototype.setGlobalValidationMessages=function(t){this.config.globalValidationMessages=t},t.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:n.Optional},{type:n.Inject,args:[s]}]}]},t.ngInjectableDef=n.defineInjectable({factory:function(){return new t(n.inject(s,8))},token:t,providedIn:"root"}),t}();function m(t,e){return t.replace("{requiredLength}",e.requiredLength.toString())}var h={minlength:m,maxlength:m,max:function S(t,e){return t.replace("{max}",e.max.toString())},min:function O(t,e){return t.replace("{min}",e.min.toString())}};var y=function(){function t(t){this.thyFormValidateLoader=t,this._controls=[],this.validations={}}return t.prototype._getValidationFeedbackStrategy=function(){var t=this._config&&this._config.validationFeedbackStrategy||this.thyFormValidateLoader.validationFeedbackStrategy;if(!t)throw new Error("validation display strategy is null");return t},t.prototype._getElement=function(t){var e=this._formElement[t];return e||this._formElement.querySelector("[name='"+t+"']")},t.prototype._clearElementError=function(t){this.validations[t]&&this.validations[t].hasError&&(this.validations[t].hasError=!1,this.validations[t].errorMessages=[],this._getValidationFeedbackStrategy().removeError(this._getElement(t)))},t.prototype._tryGetValidation=function(t){return this.validations[t]||this._initializeFormControlValidation(t,this._getControlByName(t)),this.validations[t]},t.prototype._initializeFormControlValidation=function(t,e){var r=this;this.validations[t]={hasError:!1,errorMessages:[]},e.valueChanges.subscribe(function(){r._clearElementError(t)})},t.prototype._restFormControlValidation=function(t){var e=this.validations[t];e&&(e.hasError=!1,e.errorMessages=[])},t.prototype._getValidationMessage=function(t,e,r){return function n(t,e,r){return h[t]&&r?h[t](e,r):e}(e,this._config&&this._config.validationMessages&&this._config.validationMessages[t]&&this._config.validationMessages[t][e]?this._config.validationMessages[t][e]:this.thyFormValidateLoader.getErrorMessage(t,e,r),r)},t.prototype._getValidationMessages=function(t,e){var r=[];for(var n in e)e.hasOwnProperty(n)&&r.push(this._getValidationMessage(t,n,e[n]));return r},t.prototype._setControlValidationError=function(t,e){var r=this._tryGetValidation(t);r.errorMessages=e,r.hasError=!0,this._getValidationFeedbackStrategy().showError(this._getElement(t),e)},Object.defineProperty(t.prototype,"validatorConfig",{get:function(){return this._config},enumerable:!0,configurable:!0}),t.prototype.initialize=function(t,e){this._ngForm=t,this._formElement=e},t.prototype.initializeFormControlsValidation=function(t){var r=this;(this._config&&"blur"===this._config.validateOn||"blur"===this.thyFormValidateLoader.validateOn)&&((t||[]).forEach(function(e){if(!r._controls.find(function(t){return t.name===e.name})){r._initializeFormControlValidation(e.name,e);var t=r._getElement(e.name);t&&(t.onblur=function(t){r.validateControl(e.name)})}}),this._controls=t)},t.prototype.setValidatorConfig=function(t){this._config=t},t.prototype._getControls=function(){if(this._ngForm instanceof o.NgForm)return this._ngForm.controls;if(this._ngForm instanceof o.FormGroupDirective){var e={};return this._ngForm.directives.forEach(function(t){e[t.name]=t}),e}},t.prototype._getControlByName=function(t){return this._getControls()[t]},t.prototype.validateControl=function(t){this._clearElementError(t);var e=this._getControlByName(t);if(e&&e.invalid){var r=this._getValidationMessages(t,e.errors);this._setControlValidationError(t,r)}},t.prototype.validateControls=function(){var e=this,r=this._getControls();for(var t in r)r.hasOwnProperty(t)&&(this._tryGetValidation(t),this.validateControl(t));Object.keys(this.validations).forEach(function(t){r[t]||delete e.validations[t]})},t.prototype.validate=function(t){return this._ngForm.onSubmit(t),this.validateControls(),this._ngForm.valid},t.prototype.reset=function(){for(var t in this._ngForm.reset(),this.validations)this.validations.hasOwnProperty(t)&&(this._restFormControlValidation(t),this._clearElementError(t))},t.prototype.markControlAsError=function(t,e){this._clearElementError(t),this._setControlValidationError(t,[e])},t.decorators=[{type:n.Injectable}],t.ctorParameters=function(){return[{type:p}]},t}(),v={submit:"submit",alwaysSubmit:"alwaysSubmit",forbidSubmit:"forbidSubmit"},b=function(){function t(t,e,r,n,o){this.ngZone=t,this.renderer=e,this.elementRef=r,this._validator=n,this.ngForm=o}return Object.defineProperty(t.prototype,"ngxFormValidatorConfig",{set:function(t){this.validator.setValidatorConfig(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngxFormValidator",{set:function(t){this.validator.setValidatorConfig(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"validator",{get:function(){return this._validator},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.ngZone.runOutsideAngular(function(){t.unsubscribe=t.renderer.listen(t.elementRef.nativeElement,"keydown",t.onKeydown.bind(t))}),this.validator.initialize(this.ngForm,this.elementRef.nativeElement)},t.prototype.ngAfterContentInit=function(){var e=this;this.validator.initializeFormControlsValidation(this.controls.toArray()),this.controls.changes.subscribe(function(t){e.validator.initializeFormControlsValidation(e.controls.toArray())})},t.prototype.submit=function(t){this.validator.validate(t)&&this.onSubmitSuccess&&this.onSubmitSuccess(t)},t.prototype.submitRunInZone=function(t){var e=this;this.ngZone.run(function(){e.submit(t)})},t.prototype.onKeydown=function(t){var e=document.activeElement;13===(t.which||t.keyCode)&&e.tagName&&(this.enterKeyMode&&this.enterKeyMode!==v.submit?this.enterKeyMode===v.alwaysSubmit&&(t.preventDefault(),this.submitRunInZone(t)):"TEXTAREA"===e.tagName?(t.ctrlKey||t.metaKey)&&(t.preventDefault(),this.submitRunInZone(t)):(t.preventDefault(),this.submitRunInZone(t)))},t.prototype.ngOnDestroy=function(){this.unsubscribe&&this.unsubscribe()},t.decorators=[{type:n.Directive,args:[{selector:"form[ngxFormValidator],form[ngx-form-validator]",providers:[y],exportAs:"ngxFormValidator"}]}],t.ctorParameters=function(){return[{type:n.NgZone},{type:n.Renderer2},{type:n.ElementRef},{type:y},{type:o.ControlContainer}]},t.propDecorators={controls:[{type:n.ContentChildren,args:[o.NgControl,{descendants:!0}]}],enterKeyMode:[{type:n.Input}],ngxFormValidatorConfig:[{type:n.Input}],ngxFormValidator:[{type:n.Input}]},t}(),_=function(){function t(t){this.validatorDirective=t,this.ngxFormSubmit=new n.EventEmitter}return t.prototype.ngOnInit=function(){var e=this;this.validatorDirective.onSubmitSuccess=function(t){e.ngxFormSubmit.emit(t)}},t.prototype.onSubmit=function(t){this.validatorDirective.submit(t)},t.decorators=[{type:n.Directive,args:[{selector:"[ngxFormSubmit],[ngx-form-submit]"}]}],t.ctorParameters=function(){return[{type:b}]},t.propDecorators={ngxFormSubmit:[{type:n.Output}],onSubmit:[{type:n.HostListener,args:["click",["$event"]]}]},t}(),x=function(){function t(){}return t.uniqueCheckValidator=function(e){return function(t){return t.value?e(t.value).pipe(i.map(function(t){return t?{ngxUniqueCheck:{value:!0}}:null})):r.of(null)}},t}(),V=function(){function t(){}return Object.defineProperty(t.prototype,"ngxMin",{set:function(t){this.validator=o.Validators.min(parseFloat(t))},enumerable:!0,configurable:!0}),t.prototype.validate=function(t){return this.validator(t)},t.decorators=[{type:n.Directive,args:[{selector:"[ngxMin][formControlName],[ngxMin][formControl],[ngxMin][ngModel],",providers:[{provide:o.NG_VALIDATORS,useExisting:n.forwardRef(function(){return t}),multi:!0}]}]}],t.ctorParameters=function(){return[]},t.propDecorators={ngxMin:[{type:n.Input}]},t}(),C=function(){function t(){}return Object.defineProperty(t.prototype,"ngxMax",{set:function(t){this.validator=o.Validators.max(parseFloat(t))},enumerable:!0,configurable:!0}),t.prototype.validate=function(t){return this.validator(t)},t.decorators=[{type:n.Directive,args:[{selector:"[ngxMax][formControlName],[ngxMax][formControl],[ngxMax][ngModel]",providers:[{provide:o.NG_VALIDATORS,useExisting:n.forwardRef(function(){return t}),multi:!0}]}]}],t.ctorParameters=function(){return[]},t.propDecorators={ngxMax:[{type:n.Input}]},t}(),E=function(){function t(){this.ngxUniqueCheck=function(t){return r.of(null)}}return t.prototype.validate=function(t){return x.uniqueCheckValidator(this.ngxUniqueCheck)(t)},t.decorators=[{type:n.Directive,args:[{selector:"[ngxUniqueCheck][formControlName],[ngxUniqueCheck][formControl],[ngxUniqueCheck][ngModel]",providers:[{provide:o.NG_ASYNC_VALIDATORS,useExisting:t,multi:!0}]}]}],t.ctorParameters=function(){return[]},t.propDecorators={ngxUniqueCheck:[{type:n.Input}]},t}(),F=[b,_,E,C,V],M=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:s,useValue:t}]}},e.decorators=[{type:n.NgModule,args:[{declarations:F,imports:[o.FormsModule],exports:function r(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t}(F,[o.FormsModule])}]}],e}();t.NgxValidators=x,t.NgxValidatorModule=M,t.NgxValidatorLoader=p,t.NGX_VALIDATOR_CONFIG=s,t.DEFAULT_GLOBAL_VALIDATION_MESSAGES=e,t.NgxEnterKeyMode=v,t.NgxFormValidatorDirective=b,t.NgxFormSubmitDirective=_,t.ValidationFeedbackStrategyBuilder=f,t.NoopValidationFeedbackStrategy=l,t.BootstrapValidationFeedbackStrategy=d,t.ɵc=C,t.ɵb=V,t.ɵd=E,t.ɵa=y,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=why520crazy-ngx-validator.umd.min.js.map